import{d as L,r as u,o as A,c as j,a as t,E as H,w as o,b as q,u as G,e as I,f as g,g as C,h as J,i as O,j as d,k as K,l as P,m as Q,n as W,p as X,q as Y,s as M,t as Z,v as ee,x as te,y as F,z as oe,A as l,_ as ae,B as se,F as le}from"./index-qUL-dtZK.js";/* empty css                  */import{s as b}from"./request-d3lUv3oy.js";import{U as $}from"./_prefix-Cw2jshfM.js";const ne=w=>b.post(`${$}/register`,w,{headers:{"Content-Type":"application/json"}}),re=w=>b.post(`${$}/login`,w,{headers:{"Content-Type":"application/json"}}),ue=()=>b.post(`${$}/logout`,{},{headers:{"Content-Type":"application/json"}}),de=""+new URL("avatar-DeJ2Vo1t.jpg",import.meta.url).href,me={class:"nav-bar-container"},ie={class:"left-menu"},ce={class:"right-actions"},pe={class:"el-dropdown-link"},_e={style:{display:"flex"}},ve={style:{flex:"1","padding-right":"10px"}},fe={style:{flex:"1","padding-left":"10px"}},ge=L({__name:"NavigationBar",setup(w){const D=G(),i=u(!1),c=u(""),U=u(""),S=u(""),V=u(!1),p=u(!0),_=u({username:"",password:""}),v=u({username:"",password:""});A(()=>{const n=localStorage.getItem("token"),e=localStorage.getItem("username"),a=localStorage.getItem("userId");n&&e&&a&&(U.value=n,c.value=e,S.value=a,i.value=!0)});const N=async()=>{const{username:n,password:e}=_.value;if(!/^\d{11}$/.test(n)){l.warning("手机号必须为11位数字");return}if(!/^\d{6}$/.test(e)){l.warning("密码必须为6位数字");return}try{const a=await re({username:n,password:e}),{code:r,msg:m,data:y}=a.data;if(r==="200"){const{token:k,username:x,userId:h}=y;U.value=k,c.value=x,S.value=h,i.value=!0,V.value=!1,localStorage.setItem("token",k),localStorage.setItem("username",x),localStorage.setItem("userId",h),l.success(m),location.reload()}else l.error(m)}catch{l.error("登录请求失败")}},R=async()=>{const{username:n,password:e}=v.value;if(e.length!==6||!/^\d{6}$/.test(e)){l.warning("密码必须为6位数字");return}if(!/^\d{11}$/.test(n)){l.warning("手机号必须为11位数字");return}try{const a=await ne({username:n,password:e}),{code:r,msg:m,data:y}=a.data;r==="200"&&y===!0?(l.success(m),p.value=!0):l.error(m)}catch{l.error("注册请求失败")}},T=async()=>{await ue(),i.value=!1,U.value="",c.value="",S.value="",localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("userId"),localStorage.removeItem("chatHistory"),l.success("已登出"),D.push("/"),location.reload()};return(n,e)=>{const a=O,r=K,m=Q,y=Y,k=X,x=P,h=H,E=te,f=ee,B=Z,z=q;return I(),j("div",me,[t(h,{class:"nav-bar",mode:"horizontal",router:!0},{default:o(()=>[g("div",ie,[t(a,{index:"/dashboard"},{default:o(()=>[d("RAG问答")]),_:1}),t(a,{index:"/image"},{default:o(()=>[d("表情包")]),_:1}),i.value&&c.value==="00000000000"?(I(),C(a,{key:0,index:"/ware"},{default:o(()=>[d("知识库")]),_:1})):J("",!0)]),g("div",ce,[i.value?(I(),C(x,{key:1,onCommand:T},{dropdown:o(()=>[t(k,null,{default:o(()=>[t(y,{command:"logout"},{default:o(()=>[d("退出登录")]),_:1})]),_:1})]),default:o(()=>[g("span",pe,[t(m,{size:55,fit:"cover",src:W(de)},null,8,["src"])])]),_:1})):(I(),C(r,{key:0,onClick:e[0]||(e[0]=s=>V.value=!0),type:"primary",text:""},{default:o(()=>[d("登录 | 注册")]),_:1}))])]),_:1}),t(z,{modelValue:V.value,"onUpdate:modelValue":e[6]||(e[6]=s=>V.value=s),title:"欢迎使用",width:"400px"},{footer:o(()=>[t(r,{text:"",onClick:e[5]||(e[5]=s=>p.value=!p.value)},{default:o(()=>[d(oe(p.value?"还没有账号？注册":"已有账号？登录"),1)]),_:1})]),default:o(()=>[g("div",_e,[M(g("div",ve,[t(B,{model:_.value},{default:o(()=>[t(f,{label:"用户名"},{default:o(()=>[t(E,{modelValue:_.value.username,"onUpdate:modelValue":e[1]||(e[1]=s=>_.value.username=s)},null,8,["modelValue"])]),_:1}),t(f,{label:"密码"},{default:o(()=>[t(E,{type:"password",modelValue:_.value.password,"onUpdate:modelValue":e[2]||(e[2]=s=>_.value.password=s)},null,8,["modelValue"])]),_:1}),t(f,null,{default:o(()=>[t(r,{type:"primary",onClick:N},{default:o(()=>[d("登录")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[F,p.value]]),M(g("div",fe,[t(B,{model:v.value},{default:o(()=>[t(f,{label:"用户名"},{default:o(()=>[t(E,{modelValue:v.value.username,"onUpdate:modelValue":e[3]||(e[3]=s=>v.value.username=s)},null,8,["modelValue"])]),_:1}),t(f,{label:"密码"},{default:o(()=>[t(E,{type:"password",modelValue:v.value.password,"onUpdate:modelValue":e[4]||(e[4]=s=>v.value.password=s)},null,8,["modelValue"])]),_:1}),t(f,null,{default:o(()=>[t(r,{type:"primary",onClick:R},{default:o(()=>[d("注册")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[F,!p.value]])])]),_:1},8,["modelValue"])])}}}),we=ae(ge,[["__scopeId","data-v-904eea17"]]),xe=L({__name:"Home",setup(w){return(D,i)=>{const c=se("router-view");return I(),j(le,null,[t(we),t(c)],64)}}});export{xe as default};
